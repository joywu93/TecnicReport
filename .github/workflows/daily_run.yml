name: è‚¡å¸‚æˆ°ç•¥å®šæ™‚ç™¼å ±ç³»çµ±

on:
  schedule:
    # ðŸ’¡ å°ç£æ™‚é–“èˆ‡ UTC å°ä½èªªæ˜Žï¼š
    # 01:30 UTC = 09:30 å°ç£æ™‚é–“ (é–‹ç›¤å‰)
    # 05:00 UTC = 13:00 å°ç£æ™‚é–“ (æ”¶ç›¤å‰)
    # 07:30 UTC = 15:30 å°ç£æ™‚é–“ (æ”¶ç›¤å¾Œ)
    - cron: '30 1 * * 1-5'
    - cron: '0 5 * * 1-5'
    - cron: '30 7 * * 1-5'
  workflow_dispatch: # å…è¨±æ‚¨éš¨æ™‚é»žæ“ŠæŒ‰éˆ•æ‰‹å‹•æ¸¬è©¦

jobs:
  run-daily-report:
    runs-on: ubuntu-latest
    steps:
      - name: æª¢å‡ºä»£ç¢¼ (Checkout)
        uses: actions/checkout@v3

      - name: è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: å®‰è£å¿…è¦å¥—ä»¶ (Dependencies)
        run: |
          pip install gspread pandas yfinance google-auth

      - name: åŸ·è¡Œæˆ°ç•¥åˆ†æžä¸¦ç™¼ä¿¡
        env:
          # ðŸ” è«‹å‹™å¿…åœ¨ GitHub Settings > Secrets ä¸­è¨­å®šä»¥ä¸‹ä¸‰å€‹æ¨™ç±¤
          GMAIL_USER: ${{ secrets.GMAIL_USER }}
          GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
          GOOGLE_SERVICE_ACCOUNT_JSON: ${{ secrets.GOOGLE_SERVICE_ACCOUNT_JSON }}
        run: python daily_report.py
