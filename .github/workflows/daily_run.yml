name: Daily Stock Report

on:
  schedule:
    # 這裡設定時間 (UTC 時間)
    # 台灣時間 = UTC + 8
    # 所以如果您想在台灣時間「下午 3:30 (15:30)」執行：
    # 計算公式：15 - 8 = 7，30分照填 --> '30 7 * * 1-5'
    - cron: '30 7 * * 1-5' # 目前設定為台灣時間週一至週五 15:30
    
  workflow_dispatch: # 這一行讓您可以手動點擊按鈕來測試

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'

    - name: Install dependencies
      run: |
        pip install yfinance pandas

    - name: Run daily report
      env:
        # 這裡會自動去抓您在 Secrets 設定的帳密
        GMAIL_USER: ${{ secrets.GMAIL_USER }}
        GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
      run: python daily_report.py
